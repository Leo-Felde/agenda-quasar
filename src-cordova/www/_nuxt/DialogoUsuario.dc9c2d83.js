import{m as v,f as p,_ as E}from'./usuarios.bd8c83a0.js';import{s as w,a as N,_ as V}from'./index.a988fc85.js';import{_ as D}from'./DialogoCrud.b0f606bf.js';import{i as U,c as f,s as R}from'./promptDialog.55ad8c7a.js';import{_ as C,r as l,c as h,I as g,k as O,A as b,s as S,q as x}from'./entry.262740d5.js';const j={props:{usuario:{type:Object,default:()=>({})},modelValue:Boolean},emits:['update:modelValue','atualizar'],setup(s,{emit:t}){const n=l(!1),o=l(null),c=l(!1),r=l({tipos:'ROLE_USER'}),e=l({tipos:'ROLE_USER'}),u=h(()=>!U(r.value,e.value)),d=h(()=>s.usuario.id?'Alterar usuário':'Novo usuário');g(()=>s.usuario,()=>{s.usuario.id&&_()}),g(()=>s.modelValue,a=>{c.value=a,a&&s.usuario.id&&_()});const m=async()=>{u.value?await R()&&i():i()},y=async()=>{if(o.value.validate()){if(!u.value){i();return}try{const a={usuario:f(r.value),tipos:[r.value.tipos]};a.usuario.dataNascimento=p(a.usuario.dataNascimento,!1),delete a.usuario.tipos,await v.salvar(a),N(s.usuario.id?'Usuario atualizado':'Usuario cadastrado'),t('atualizar'),i()}catch(a){console.error(a),w('Não foi possível salvar as alterações')}finally{n.value=!1}}},_=async()=>{try{const a=await v.buscar(s.usuario.id);e.value=a.data.object.usuario,e.value.dataNascimento=p(e.value.dataNascimento),e.value.tipos=a.data.object.tipos[0],r.value=f(e.value)}catch(a){console.error(a),w('Não foi possível carregar o usuario')}finally{n.value=!1}},i=()=>{e.value={tipos:'ROLE_USER'},r.value=f(e.value),o.value.resetValidation(),t('update:modelValue',!1)};return{formulario:o,showDialog:c,titulo:d,usuarioSelecionado:r,usuarioOriginal:e,cancelar:m,salvar:y}}};function k(s,t,n,o,c,r){const e=E,u=V,d=D;return O(),b(d,{modelValue:o.showDialog,'onUpdate:modelValue':t[0]||(t[0]=m=>o.showDialog=m),title:o.titulo,onSalvar:o.salvar,onCancelar:o.cancelar},{default:S(()=>[x(u,{ref:'formulario'},{default:S(()=>[x(e,{class:'ma-3',usuario:o.usuarioSelecionado,'show-password-field':!o.usuarioSelecionado.id},null,8,['usuario','show-password-field'])]),_:1},512)]),_:1},8,['modelValue','title','onSalvar','onCancelar'])}const F=C(j,[['render',k]]);export{F as _}
